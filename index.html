<!doctype html>
<html lang="en"> 
	<head>
		<meta charset="UTF-8" />
                <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
                <meta http-equiv="Pragma" content="no-cache" />
                <meta http-equiv="Expires" content="0" />

		<title>r/place clone</title>

		<script src="jquery-3.1.1.min.js"></script>
		<script type="text/javascript">
	
			var socket;

			$(function(){
				socket = new WebSocket(" wss://21vsx3848b.execute-api.us-east-1.amazonaws.com/production");
				socket.onopen = function (event) {
					$('#sendButton').removeAttr('disabled');
				};
				socket.onclose = function (event) {
					alert("closed code:" + event.code + " reason:" +event.reason + " wasClean:"+event.wasClean);
				};
				socket.onmessage = function (event) {
					var o=JSON.parse(event.data);
					console.log("o.message:" + o.message)
					$.fn.setPixel(o.message.x, o.message.y, o.message.color)
				}

				$.fn.setPixel = function(x, y, color){ 
					var context = document.getElementById('canvas').getContext('2d');
					var r = 0;
					var g = 0;
					var b = 0;
					if (color == "Black") {
						r = 255;
						g = 255;
						b = 255;
					} else if (color == "Red") {
						r = 255;
					} else if (color == "Green") {
						g = 255;
					} else if (color == "Blue") {
						b = 255;
					} else if (color == "Orange") {
						r = 255;
						g = 165;
					} else if (color == "Yellow") {
						r = 255;
						g = 255;
					} else if (color == "Purple") {
						r = 255;
						b = 255;
					}
					context.fillStyle = 'rgb('+r+','+g+','+b+')';
		   			context.fillRect(x, y, 10, 10);
    			}

				$('#setForm').submit(function( event ) {
					var o = {"action": "sendupdate", "message": { 
						'x': $('#x').val(), 
						'y': $('#y').val(), 
						'color':$('#colors').val()
						}
					};
					o["message"]['x']=parseInt(o["message"]['x']);
					o["message"]['y']=parseInt(o["message"]['y']);
					$.fn.setPixel(o["message"]['x'], o["message"]['y'], o["message"]['color'] )
					socket.send(JSON.stringify(o));
  					event.preventDefault();
				});
			});
		</script>
		<style>
                        body {
                                text-align: center;
                                align: center;
                                overflow: hidden;
                                margin: 0px;
                                padding: 0px;
                        }
                        canvas {
                                border: 1px solid black;
                        }
                        input[type=number]{ width: 3em; }
                </style>
	</head>
	<body>
		<h1>r/place clone</h1>

		<canvas id="canvas" width="250" height="250" ></canvas>
		<form id="setForm">
                        (<input type="number" id="x" placeholder="x" min="0" max="250">,
                        <input type="number" id="y" placeholder="y" min="0" max="250">)
                        &nbsp; &nbsp; &nbsp;
						(<select name="colors" id="colors">
							<option value="Red">Red</option>
							<option value="Orange">Orange</option>
							<option value="Yellow">Yellow</option>
							<option value="Green">Green</option>
							<option value="Blue">Blue</option>
							<option value="Purple">Purple</option>
							<option value="White">White</option>
							<option value="Black">Black</option>
						  </select>)
                        &nbsp; &nbsp; &nbsp;
                        <input type="submit" name="set" value="set"/>
                </form>
	</body>
</html>

